============================= test session starts ==============================
platform darwin -- Python 3.12.11, pytest-9.0.2, pluggy-1.6.0 -- /Users/m/Zen/Code/ChatFilter/.venv/bin/python
cachedir: .pytest_cache
rootdir: /Users/m/Zen/Code/ChatFilter
configfile: pyproject.toml
plugins: anyio-4.12.1, asyncio-1.3.0
asyncio: mode=Mode.AUTO, debug=False, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
collecting ... collected 191 items

tests/test_session.py::TestSessionData::test_creation PASSED             [  0%]
tests/test_session.py::TestSessionData::test_get_missing_key PASSED      [  1%]
tests/test_session.py::TestSessionData::test_get_existing_key PASSED     [  1%]
tests/test_session.py::TestSessionData::test_set PASSED                  [  2%]
tests/test_session.py::TestSessionData::test_delete PASSED               [  2%]
tests/test_session.py::TestSessionData::test_delete_missing_key PASSED   [  3%]
tests/test_session.py::TestSessionData::test_clear PASSED                [  3%]
tests/test_session.py::TestSessionData::test_touch PASSED                [  4%]
tests/test_session.py::TestSessionData::test_is_expired_false PASSED     [  4%]
tests/test_session.py::TestSessionData::test_is_expired_true PASSED      [  5%]
tests/test_session.py::TestSessionData::test_is_expired_custom_ttl PASSED [  5%]
tests/test_session.py::TestSessionStore::test_create_session PASSED      [  6%]
tests/test_session.py::TestSessionStore::test_create_session_unique_ids PASSED [  6%]
tests/test_session.py::TestSessionStore::test_get_session_existing PASSED [  7%]
tests/test_session.py::TestSessionStore::test_get_session_touches PASSED [  7%]
tests/test_session.py::TestSessionStore::test_get_session_missing PASSED [  8%]
tests/test_session.py::TestSessionStore::test_get_session_beyond_ttl PASSED [  8%]
tests/test_session.py::TestSessionStore::test_delete_session PASSED      [  9%]
tests/test_session.py::TestSessionStore::test_delete_session_missing PASSED [  9%]
tests/test_session.py::TestSessionStore::test_cleanup_expired PASSED     [ 10%]
tests/test_session.py::TestSessionStore::test_get_session_count PASSED   [ 10%]
tests/test_session.py::TestSessionStore::test_thread_safety PASSED       [ 11%]
tests/test_session.py::TestGetSessionStore::test_returns_store PASSED    [ 12%]
tests/test_session.py::TestGetSessionStore::test_singleton PASSED        [ 12%]
tests/test_session.py::TestGetSession::test_creates_new_session PASSED   [ 13%]
tests/test_session.py::TestGetSession::test_returns_existing_session_from_state PASSED [ 13%]
tests/test_session.py::TestGetSession::test_returns_session_from_cookie PASSED [ 14%]
tests/test_session.py::TestGetSession::test_creates_new_if_cookie_invalid PASSED [ 14%]
tests/test_session.py::TestGetSession::test_attaches_to_request_state PASSED [ 15%]
tests/test_session.py::TestSetSessionCookie::test_sets_cookie PASSED     [ 15%]
tests/test_session.py::TestSetSessionCookie::test_cookie_security_settings PASSED [ 16%]
tests/test_session.py::TestDeleteSessionCookie::test_deletes_cookie PASSED [ 16%]
tests/test_session.py::TestSessionIntegration::test_full_session_lifecycle PASSED [ 17%]
tests/test_session.py::TestSessionIntegration::test_multiple_independent_sessions PASSED [ 17%]
tests/test_session_manager.py::TestSessionManagerRegistration::test_register_session PASSED [ 18%]
tests/test_session_manager.py::TestSessionManagerRegistration::test_list_sessions_empty PASSED [ 18%]
tests/test_session_manager.py::TestSessionManagerRegistration::test_unregister_session PASSED [ 19%]
tests/test_session_manager.py::TestSessionManagerConnect::test_connect_success PASSED [ 19%]
tests/test_session_manager.py::TestSessionManagerConnect::test_connect_already_connected PASSED [ 20%]
tests/test_session_manager.py::TestSessionManagerConnect::test_connect_failure PASSED [ 20%]
tests/test_session_manager.py::TestSessionManagerConnect::test_connect_timeout PASSED [ 21%]
tests/test_session_manager.py::TestSessionManagerConnect::test_connect_unregistered_session PASSED [ 21%]
tests/test_session_manager.py::TestSessionManagerDisconnect::test_disconnect_connected_session PASSED [ 22%]
tests/test_session_manager.py::TestSessionManagerDisconnect::test_disconnect_not_connected PASSED [ 23%]
tests/test_session_manager.py::TestSessionManagerDisconnect::test_disconnect_nonexistent PASSED [ 23%]
tests/test_session_manager.py::TestSessionManagerDisconnect::test_disconnect_all PASSED [ 24%]
tests/test_session_manager.py::TestSessionManagerContextManager::test_context_manager_auto_disconnect PASSED [ 24%]
tests/test_session_manager.py::TestSessionManagerContextManager::test_context_manager_no_auto_disconnect PASSED [ 25%]
tests/test_session_manager.py::TestSessionManagerContextManager::test_context_manager_exception_still_disconnects PASSED [ 25%]
tests/test_session_manager.py::TestSessionManagerHealthCheck::test_is_healthy_connected PASSED [ 26%]
tests/test_session_manager.py::TestSessionManagerHealthCheck::test_is_healthy_not_connected PASSED [ 26%]
tests/test_session_manager.py::TestSessionManagerHealthCheck::test_is_healthy_nonexistent PASSED [ 27%]
tests/test_session_manager.py::TestSessionManagerInfo::test_get_info_registered_not_connected PASSED [ 27%]
tests/test_session_manager.py::TestSessionManagerInfo::test_get_info_connected PASSED [ 28%]
tests/test_session_manager.py::TestSessionManagerInfo::test_get_info_nonexistent PASSED [ 28%]
tests/test_session_manager.py::TestSessionManagerLocking::test_concurrent_connects_rejected PASSED [ 29%]
tests/test_session_manager.py::TestSessionManagerLocking::test_unregister_connected_raises PASSED [ 29%]
tests/test_session_manager.py::TestSessionAuthErrors::test_connect_session_revoked_error PASSED [ 30%]
tests/test_session_manager.py::TestSessionAuthErrors::test_connect_auth_key_unregistered_error PASSED [ 30%]
tests/test_session_manager.py::TestSessionAuthErrors::test_connect_phone_banned_error PASSED [ 31%]
tests/test_session_manager.py::TestSessionAuthErrors::test_connect_user_deactivated_ban_error PASSED [ 31%]
tests/test_session_manager.py::TestSessionAuthErrors::test_connect_session_password_needed_error PASSED [ 32%]
tests/test_session_manager.py::TestSessionAuthErrors::test_connect_telethon_auth_expiry_error PASSED [ 32%]
tests/test_session_manager.py::TestSessionAuthErrors::test_invalid_session_state_and_error_message PASSED [ 33%]
tests/test_session_manager.py::TestSessionAuthErrors::test_reauth_required_state_and_error_message PASSED [ 34%]
tests/test_session_manager.py::TestNetworkSwitchHandling::test_is_network_switch_error_broken_pipe PASSED [ 34%]
tests/test_session_manager.py::TestNetworkSwitchHandling::test_is_network_switch_error_connection_reset PASSED [ 35%]
tests/test_session_manager.py::TestNetworkSwitchHandling::test_is_network_switch_error_connection_aborted PASSED [ 35%]
tests/test_session_manager.py::TestNetworkSwitchHandling::test_is_network_switch_error_oserror_with_errno PASSED [ 36%]
tests/test_session_manager.py::TestNetworkSwitchHandling::test_is_network_switch_error_oserror_by_message PASSED [ 36%]
tests/test_session_manager.py::TestNetworkSwitchHandling::test_is_network_switch_error_regular_error PASSED [ 37%]
tests/test_session_manager.py::TestNetworkSwitchHandling::test_handle_network_switch_reconnects PASSED [ 37%]
tests/test_session_manager.py::TestNetworkSwitchHandling::test_handle_network_switch_sets_recovery_flag PASSED [ 38%]
tests/test_session_manager.py::TestNetworkSwitchHandling::test_handle_network_switch_resets_error_tracking PASSED [ 38%]
tests/test_session_manager.py::TestNetworkSwitchHandling::test_network_error_tracking_in_info PASSED [ 39%]
tests/test_session_manager.py::TestNetworkSwitchHandling::test_health_check_clears_old_network_errors PASSED [ 39%]
tests/test_session_manager.py::TestNetworkSwitchIntegration::test_health_check_detects_and_recovers_from_network_switch PASSED [ 40%]
tests/test_session_manager.py::TestDeadSessionRecoveryFlow::test_dead_session_shows_expired_error_message PASSED [ 40%]
tests/test_session_manager.py::TestDeadSessionRecoveryFlow::test_dead_session_revoked_shows_distinct_status PASSED [ 41%]
tests/test_session_manager.py::TestDeadSessionRecoveryFlow::test_dead_session_banned_account_shows_permanent_status PASSED [ 41%]
tests/test_session_manager.py::TestDeadSessionRecoveryFlow::test_temporary_error_vs_permanent_session_death PASSED [ 42%]
tests/test_session_manager.py::TestDeadSessionRecoveryFlow::test_session_recovery_preserves_session_id PASSED [ 42%]
tests/test_session_manager.py::TestDeadSessionRecoveryFlow::test_reauth_required_error_is_recoverable PASSED [ 43%]
tests/test_session_manager.py::TestDeadSessionRecoveryFlow::test_reconnect_flow_same_session_id PASSED [ 43%]
tests/test_session_manager.py::TestAuthKeyUnregisteredAutoRecovery::test_connect_authkey_unregistered_auto_delete PASSED [ 44%]
tests/test_session_manager.py::TestAuthKeyUnregisteredAutoRecovery::test_session_file_deletion_signaled_for_authkey_unregistered PASSED [ 45%]
tests/test_session_manager.py::TestAuthKeyUnregisteredAutoRecovery::test_reregister_after_authkey_unregistered_allows_recovery PASSED [ 45%]
tests/test_session_manager.py::TestAuthKeyUnregisteredAutoRecovery::test_authkey_unregistered_vs_other_auth_errors PASSED [ 46%]
tests/test_sessions_router.py::TestReadUploadWithSizeLimit::test_read_small_file PASSED [ 46%]
tests/test_sessions_router.py::TestReadUploadWithSizeLimit::test_read_file_exceeds_limit PASSED [ 47%]
tests/test_sessions_router.py::TestReadUploadWithSizeLimit::test_read_exact_limit PASSED [ 47%]
tests/test_sessions_router.py::TestReadUploadWithSizeLimit::test_read_chunked_file PASSED [ 48%]
tests/test_sessions_router.py::TestSanitizeSessionName::test_valid_name_alphanumeric PASSED [ 48%]
tests/test_sessions_router.py::TestSanitizeSessionName::test_valid_name_with_underscore PASSED [ 49%]
tests/test_sessions_router.py::TestSanitizeSessionName::test_valid_name_with_hyphen PASSED [ 49%]
tests/test_sessions_router.py::TestSanitizeSessionName::test_removes_path_traversal PASSED [ 50%]
tests/test_sessions_router.py::TestSanitizeSessionName::test_removes_special_characters PASSED [ 50%]
tests/test_sessions_router.py::TestSanitizeSessionName::test_empty_after_sanitization_raises PASSED [ 51%]
tests/test_sessions_router.py::TestSanitizeSessionName::test_truncates_long_name PASSED [ 51%]
tests/test_sessions_router.py::TestValidateSessionFileFormat::test_valid_session_file PASSED [ 52%]
tests/test_sessions_router.py::TestValidateSessionFileFormat::test_invalid_not_sqlite PASSED [ 52%]
tests/test_sessions_router.py::TestValidateSessionFileFormat::test_invalid_missing_sessions_table PASSED [ 53%]
tests/test_sessions_router.py::TestValidateSessionFileFormat::test_invalid_empty_sessions PASSED [ 53%]
tests/test_sessions_router.py::TestValidateSessionFileFormat::test_telethon_2x_session_rejected PASSED [ 54%]
tests/test_sessions_router.py::TestValidateSessionFileFormat::test_valid_telethon_1x_session PASSED [ 54%]
tests/test_sessions_router.py::TestValidateConfigFileFormat::test_valid_config PASSED [ 55%]
tests/test_sessions_router.py::TestValidateConfigFileFormat::test_valid_config_api_id_as_string PASSED [ 56%]
tests/test_sessions_router.py::TestValidateConfigFileFormat::test_invalid_json PASSED [ 56%]
tests/test_sessions_router.py::TestValidateConfigFileFormat::test_missing_api_id PASSED [ 57%]
tests/test_sessions_router.py::TestValidateConfigFileFormat::test_missing_api_hash PASSED [ 57%]
tests/test_sessions_router.py::TestValidateConfigFileFormat::test_invalid_api_id_type PASSED [ 58%]
tests/test_sessions_router.py::TestValidateConfigFileFormat::test_empty_api_hash PASSED [ 58%]
tests/test_sessions_router.py::TestValidateConfigFileFormat::test_empty_config_file PASSED [ 59%]
tests/test_sessions_router.py::TestValidateConfigFileFormat::test_whitespace_only_config PASSED [ 59%]
tests/test_sessions_router.py::TestValidateConfigFileFormat::test_not_json_object_array PASSED [ 60%]
tests/test_sessions_router.py::TestValidateConfigFileFormat::test_not_json_object_string PASSED [ 60%]
tests/test_sessions_router.py::TestValidateConfigFileFormat::test_invalid_utf8 PASSED [ 61%]
tests/test_sessions_router.py::TestValidateConfigFileFormat::test_unknown_fields_lenient PASSED [ 61%]
tests/test_sessions_router.py::TestValidateConfigFileFormat::test_no_warning_for_known_fields_only PASSED [ 62%]
tests/test_sessions_router.py::TestSessionsAPIEndpoints::test_get_sessions_empty PASSED [ 62%]
tests/test_sessions_router.py::TestSessionsAPIEndpoints::test_home_page_loads PASSED [ 63%]
tests/test_sessions_router.py::TestSessionsAPIEndpoints::test_upload_session_invalid_name PASSED [ 63%]
tests/test_sessions_router.py::TestSessionsAPIEndpoints::test_upload_session_invalid_session_file PASSED [ 64%]
tests/test_sessions_router.py::TestSessionsAPIEndpoints::test_upload_session_invalid_config PASSED [ 64%]
tests/test_sessions_router.py::TestSessionsAPIEndpoints::test_delete_session_not_found PASSED [ 65%]
tests/test_sessions_router.py::TestSessionsAPIEndpoints::test_delete_session_invalid_name PASSED [ 65%]
tests/test_sessions_router.py::TestSessionsAPIEndpoints::test_upload_config_file_too_large PASSED [ 66%]
tests/test_sessions_router.py::TestSessionsAPIEndpoints::test_upload_session_file_too_large PASSED [ 67%]
tests/test_sessions_router.py::TestSessionsAPIEndpoints::test_upload_session_with_json_file PASSED [ 67%]
tests/test_sessions_router.py::TestSessionsAPIEndpoints::test_upload_session_json_invalid PASSED [ 68%]
tests/test_sessions_router.py::TestSessionsAPIEndpoints::test_upload_session_json_with_2fa PASSED [ 68%]
tests/test_sessions_router.py::TestMigrateLegacySessions::test_migrate_legacy_session_creates_config PASSED [ 69%]
tests/test_sessions_router.py::TestMigrateLegacySessions::test_migrate_skips_already_migrated PASSED [ 69%]
tests/test_sessions_router.py::TestMigrateLegacySessions::test_migrate_handles_missing_credentials PASSED [ 70%]
tests/test_sessions_router.py::TestMigrateLegacySessions::test_migrate_skips_non_session_directories PASSED [ 70%]
tests/test_sessions_router.py::TestSessionConfigAPI::test_get_session_config_success PASSED [ 71%]
tests/test_sessions_router.py::TestSessionConfigAPI::test_get_session_config_not_found PASSED [ 71%]
tests/test_sessions_router.py::TestSessionConfigAPI::test_get_session_config_invalid_name PASSED [ 72%]
tests/test_sessions_router.py::TestSessionConfigAPI::test_update_session_config_success PASSED [ 72%]
tests/test_sessions_router.py::TestSessionConfigAPI::test_update_session_config_proxy_required PASSED [ 73%]
tests/test_sessions_router.py::TestSessionConfigAPI::test_update_session_config_proxy_not_found PASSED [ 73%]
tests/test_sessions_router.py::TestSessionConfigAPI::test_update_session_config_session_not_found PASSED [ 74%]
tests/test_sessions_router.py::TestSessionConnectDisconnectAPI::test_connect_session_not_found PASSED [ 74%]
tests/test_sessions_router.py::TestSessionConnectDisconnectAPI::test_connect_session_invalid_name PASSED [ 75%]
tests/test_sessions_router.py::TestSessionConnectDisconnectAPI::test_connect_session_not_configured PASSED [ 75%]
tests/test_sessions_router.py::TestSessionConnectDisconnectAPI::test_connect_session_proxy_missing PASSED [ 76%]
tests/test_sessions_router.py::TestSessionConnectDisconnectAPI::test_connect_session_success PASSED [ 76%]
tests/test_sessions_router.py::TestSessionConnectDisconnectAPI::test_connect_session_failure PASSED [ 77%]
tests/test_sessions_router.py::TestSessionConnectDisconnectAPI::test_connect_session_concurrent_request_returns_connecting PASSED [ 78%]
tests/test_sessions_router.py::TestSessionConnectDisconnectAPI::test_connect_session_timeout_returns_connecting PASSED [ 78%]
tests/test_sessions_router.py::TestSessionConnectDisconnectAPI::test_connect_session_missing_session_file PASSED [ 79%]
tests/test_sessions_router.py::TestSessionConnectDisconnectAPI::test_connect_session_invalid_session_auto_reauth PASSED [ 79%]
tests/test_sessions_router.py::TestSessionConnectDisconnectAPI::test_disconnect_session_invalid_name PASSED [ 80%]
tests/test_sessions_router.py::TestSessionConnectDisconnectAPI::test_disconnect_session_success PASSED [ 80%]
tests/test_sessions_router.py::TestSessionConnectDisconnectAPI::test_disconnect_session_not_connected FAILED [ 81%]
tests/test_sessions_router.py::TestDeadSessionRecoveryUX::test_dead_session_returns_connecting_state PASSED [ 81%]
tests/test_sessions_router.py::TestDeadSessionRecoveryUX::test_expired_session_connect_returns_connecting PASSED [ 82%]
tests/test_sessions_router.py::TestDeadSessionRecoveryUX::test_session_recovery_preserves_session_id PASSED [ 82%]
tests/test_sessions_router.py::TestDeadSessionRecoveryUX::test_temporary_error_vs_permanent_session_death_ui PASSED [ 83%]
tests/test_sessions_router.py::TestAPICredentialReValidation::test_change_api_id_triggers_disconnect_and_reauth PASSED [ 83%]
tests/test_sessions_router.py::TestAPICredentialReValidation::test_invalid_api_id_rejected_not_saved PASSED [ 84%]
tests/test_sessions_router.py::TestAPICredentialReValidation::test_valid_credentials_needing_auth_triggers_reconnect PASSED [ 84%]
tests/test_sessions_router.py::TestAPICredentialReValidation::test_credentials_not_saved_before_validation_success PASSED [ 85%]
tests/test_sessions_router.py::TestAPICredentialReValidation::test_network_error_during_validation_shows_proxy_error PASSED [ 85%]
tests/test_sessions_router.py::TestVerify2FA::test_password_validation_logic PASSED [ 86%]
tests/test_sessions_router.py::TestVerify2FA::test_verify_code_2fa_auto_fails_shows_manual_modal PASSED [ 86%]
tests/test_sessions_router.py::TestBackwardCompatibilityLegacySessions::test_list_sessions_legacy_format_without_account_info PASSED [ 87%]
tests/test_sessions_router.py::TestBackwardCompatibilityLegacySessions::test_connect_legacy_session_without_phone PASSED [ 87%]
tests/test_sessions_router.py::TestBackwardCompatibilityLegacySessions::test_legacy_session_shown_as_disconnected_after_migration PASSED [ 88%]
tests/test_sessions_router.py::TestBackwardCompatibilityLegacySessions::test_list_stored_sessions_without_session_file PASSED [ 89%]
tests/test_sessions_router.py::TestValidateAccountInfoJson::test_valid_json_minimal PASSED [ 89%]
tests/test_sessions_router.py::TestValidateAccountInfoJson::test_valid_json_all_fields PASSED [ 90%]
tests/test_sessions_router.py::TestValidateAccountInfoJson::test_valid_phone_without_plus PASSED [ 90%]
tests/test_sessions_router.py::TestValidateAccountInfoJson::test_invalid_not_dict PASSED [ 91%]
tests/test_sessions_router.py::TestValidateAccountInfoJson::test_invalid_unknown_fields PASSED [ 91%]
tests/test_sessions_router.py::TestValidateAccountInfoJson::test_invalid_nested_object PASSED [ 92%]
tests/test_sessions_router.py::TestValidateAccountInfoJson::test_invalid_nested_array PASSED [ 92%]
tests/test_sessions_router.py::TestValidateAccountInfoJson::test_invalid_missing_phone PASSED [ 93%]
tests/test_sessions_router.py::TestValidateAccountInfoJson::test_invalid_empty_phone PASSED [ 93%]
tests/test_sessions_router.py::TestValidateAccountInfoJson::test_invalid_phone_format_letters PASSED [ 94%]
tests/test_sessions_router.py::TestValidateAccountInfoJson::test_invalid_phone_too_short PASSED [ 94%]
tests/test_sessions_router.py::TestValidateAccountInfoJson::test_invalid_phone_too_long PASSED [ 95%]
tests/test_sessions_router.py::TestValidateAccountInfoJson::test_invalid_phone_leading_zero PASSED [ 95%]
tests/test_sessions_router.py::TestVerifyCode2FAAutoEntry::test_verify_code_auto_2fa_success PASSED [ 96%]
tests/test_sessions_router.py::TestVerifyCode2FAAutoEntry::test_verify_code_auto_2fa_missing PASSED [ 96%]
tests/test_sessions_router.py::TestVerifyCode2FAAutoEntry::test_verify_code_auto_2fa_wrong PASSED [ 97%]
tests/test_sessions_router.py::TestSessionImport::test_validate_import_session_success PASSED [ 97%]
tests/test_sessions_router.py::TestSessionImport::test_validate_import_session_invalid_json_missing_phone PASSED [ 98%]
tests/test_sessions_router.py::TestSessionImport::test_validate_import_session_invalid_phone_format PASSED [ 98%]
tests/test_sessions_router.py::TestSessionImport::test_save_import_session_success PASSED [ 99%]
tests/test_sessions_router.py::TestSessionImport::test_save_import_session_duplicate_name PASSED [100%]

=================================== FAILURES ===================================
____ TestSessionConnectDisconnectAPI.test_disconnect_session_not_connected _____
tests/test_sessions_router.py:1953: in test_disconnect_session_not_connected
    assert "Connect" in response.text
E   assert 'Connect' in '\n\n<tr id="session-test_session" class="account-row">\n    <td class="account-name-cell">\n        <span class="account-name">test_session</span>\n    </td>\n    <td class="account-status-cell">\n        <span class="account-status status-disconnected status-needs-auth"\n              title="No cached session - authorization required"\n              ><span class="status-icon" aria-hidden="true">\U0001f4f1</span>\n                    Needs Auth</span>\n    </td>\n    <td class="account-actions-cell">\n        <div class="account-actions">\n            \n            <div class="session-connection-btn-wrapper" id="session-connection-test_session">\n                \n                <button class="btn btn-sm btn-success session-connect-btn"\n                        hx-post="/api/sessions/test_session/connect"\n                        hx-target="#session-test_session"\n                        hx-swap="outerHTML"\n                        hx-disabled-elt="this"\n                        aria-label="Authorize session">\n                    Authorize\n                </button>\n                \n            </div>\n            <button class="btn btn-sm btn-secondary session-config-btn"\n                    data-session-id="test_session"\n                    hx-get="/api/sessions/test_session/config"\n                    hx-target="#session-config-test_session"\n                    hx-swap="innerHTML"\n                    hx-disabled-elt="this"\n                    aria-label="Configure account"\n                    aria-expanded="false"\n                    aria-controls="session-config-test_session">\n                Edit\n            </button>\n            <button class="btn btn-sm btn-danger session-delete-btn"\n                    data-session-id="test_session"\n                    data-lock="session:test_session:delete"\n                    aria-label="Delete account">\n                Delete\n            </button>\n        </div>\n    </td>\n</tr>'
E    +  where '\n\n<tr id="session-test_session" class="account-row">\n    <td class="account-name-cell">\n        <span class="account-name">test_session</span>\n    </td>\n    <td class="account-status-cell">\n        <span class="account-status status-disconnected status-needs-auth"\n              title="No cached session - authorization required"\n              ><span class="status-icon" aria-hidden="true">\U0001f4f1</span>\n                    Needs Auth</span>\n    </td>\n    <td class="account-actions-cell">\n        <div class="account-actions">\n            \n            <div class="session-connection-btn-wrapper" id="session-connection-test_session">\n                \n                <button class="btn btn-sm btn-success session-connect-btn"\n                        hx-post="/api/sessions/test_session/connect"\n                        hx-target="#session-test_session"\n                        hx-swap="outerHTML"\n                        hx-disabled-elt="this"\n                        aria-label="Authorize session">\n                    Authorize\n                </button>\n                \n            </div>\n            <button class="btn btn-sm btn-secondary session-config-btn"\n                    data-session-id="test_session"\n                    hx-get="/api/sessions/test_session/config"\n                    hx-target="#session-config-test_session"\n                    hx-swap="innerHTML"\n                    hx-disabled-elt="this"\n                    aria-label="Configure account"\n                    aria-expanded="false"\n                    aria-controls="session-config-test_session">\n                Edit\n            </button>\n            <button class="btn btn-sm btn-danger session-delete-btn"\n                    data-session-id="test_session"\n                    data-lock="session:test_session:delete"\n                    aria-label="Delete account">\n                Delete\n            </button>\n        </div>\n    </td>\n</tr>' = <Response [200 OK]>.text
=============================== warnings summary ===============================
.venv/lib/python3.12/site-packages/_pytest/config/__init__.py:1428
  /Users/m/Zen/Code/ChatFilter/.venv/lib/python3.12/site-packages/_pytest/config/__init__.py:1428: PytestConfigWarning: Unknown config option: timeout
  
    self._warn_or_fail_if_strict(f"Unknown config option: {key}\n")

tests/test_sessions_router.py::TestSessionConfigAPI::test_update_session_config_proxy_required
  /Users/m/Zen/Code/ChatFilter/.venv/lib/python3.12/site-packages/starlette/_exception_handler.py:59: DeprecationWarning: 'HTTP_422_UNPROCESSABLE_ENTITY' is deprecated. Use 'HTTP_422_UNPROCESSABLE_CONTENT' instead.
    response = await handler(conn, exc)

tests/test_sessions_router.py::TestAPICredentialReValidation::test_invalid_api_id_rejected_not_saved
tests/test_sessions_router.py::TestAPICredentialReValidation::test_credentials_not_saved_before_validation_success
  /Users/m/Zen/Code/ChatFilter/src/chatfilter/web/routers/sessions.py:1001: RuntimeWarning: coroutine 'AsyncMockMixin._execute_mock_call' was never awaited
    if client and client.is_connected():
  Enable tracemalloc to get traceback where the object was allocated.
  See https://docs.pytest.org/en/stable/how-to/capture-warnings.html#resource-warnings for more info.

tests/test_sessions_router.py::TestAPICredentialReValidation::test_network_error_during_validation_shows_proxy_error
  /Users/m/Zen/Code/ChatFilter/src/chatfilter/web/routers/sessions.py:1010: RuntimeWarning: coroutine 'AsyncMockMixin._execute_mock_call' was never awaited
    if client and client.is_connected():
  Enable tracemalloc to get traceback where the object was allocated.
  See https://docs.pytest.org/en/stable/how-to/capture-warnings.html#resource-warnings for more info.

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED tests/test_sessions_router.py::TestSessionConnectDisconnectAPI::test_disconnect_session_not_connected - assert 'Connect' in '\n\n<tr id="session-test_session" class="account-row">\n    <td class="account-name-cell">\n        <span class="account-name">test_session</span>\n    </td>\n    <td class="account-status-cell">\n        <span class="account-status status-disconnected status-needs-auth"\n              title="No cached session - authorization required"\n              ><span class="status-icon" aria-hidden="true">\U0001f4f1</span>\n                    Needs Auth</span>\n    </td>\n    <td class="account-actions-cell">\n        <div class="account-actions">\n            \n            <div class="session-connection-btn-wrapper" id="session-connection-test_session">\n                \n                <button class="btn btn-sm btn-success session-connect-btn"\n                        hx-post="/api/sessions/test_session/connect"\n                        hx-target="#session-test_session"\n                        hx-swap="outerHTML"\n                        hx-disabled-elt="this"\n                        aria-label="Authorize session">\n                    Authorize\n                </button>\n                \n            </div>\n            <button class="btn btn-sm btn-secondary session-config-btn"\n                    data-session-id="test_session"\n                    hx-get="/api/sessions/test_session/config"\n                    hx-target="#session-config-test_session"\n                    hx-swap="innerHTML"\n                    hx-disabled-elt="this"\n                    aria-label="Configure account"\n                    aria-expanded="false"\n                    aria-controls="session-config-test_session">\n                Edit\n            </button>\n            <button class="btn btn-sm btn-danger session-delete-btn"\n                    data-session-id="test_session"\n                    data-lock="session:test_session:delete"\n                    aria-label="Delete account">\n                Delete\n            </button>\n        </div>\n    </td>\n</tr>'
 +  where '\n\n<tr id="session-test_session" class="account-row">\n    <td class="account-name-cell">\n        <span class="account-name">test_session</span>\n    </td>\n    <td class="account-status-cell">\n        <span class="account-status status-disconnected status-needs-auth"\n              title="No cached session - authorization required"\n              ><span class="status-icon" aria-hidden="true">\U0001f4f1</span>\n                    Needs Auth</span>\n    </td>\n    <td class="account-actions-cell">\n        <div class="account-actions">\n            \n            <div class="session-connection-btn-wrapper" id="session-connection-test_session">\n                \n                <button class="btn btn-sm btn-success session-connect-btn"\n                        hx-post="/api/sessions/test_session/connect"\n                        hx-target="#session-test_session"\n                        hx-swap="outerHTML"\n                        hx-disabled-elt="this"\n                        aria-label="Authorize session">\n                    Authorize\n                </button>\n                \n            </div>\n            <button class="btn btn-sm btn-secondary session-config-btn"\n                    data-session-id="test_session"\n                    hx-get="/api/sessions/test_session/config"\n                    hx-target="#session-config-test_session"\n                    hx-swap="innerHTML"\n                    hx-disabled-elt="this"\n                    aria-label="Configure account"\n                    aria-expanded="false"\n                    aria-controls="session-config-test_session">\n                Edit\n            </button>\n            <button class="btn btn-sm btn-danger session-delete-btn"\n                    data-session-id="test_session"\n                    data-lock="session:test_session:delete"\n                    aria-label="Delete account">\n                Delete\n            </button>\n        </div>\n    </td>\n</tr>' = <Response [200 OK]>.text
================== 1 failed, 190 passed, 5 warnings in 18.29s ==================
