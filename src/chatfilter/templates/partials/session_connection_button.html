{# Session connection button partial #}
{# Receives: session_id, state, error (optional) #}
<div class="session-connection-btn-wrapper" id="session-connection-{{ session_id }}">
    {% if state == 'connected' %}
    <button class="btn btn-sm btn-warning session-disconnect-btn"
            hx-post="/api/sessions/{{ session_id }}/disconnect"
            hx-target="#session-connection-{{ session_id }}"
            hx-swap="outerHTML"
            aria-label="{{ _('Disconnect session') }}">
        {{ _("Disconnect") }}
    </button>
    {% elif state == 'disconnected' %}
    <button class="btn btn-sm btn-success session-connect-btn"
            hx-post="/api/sessions/{{ session_id }}/connect"
            hx-target="#session-connection-{{ session_id }}"
            hx-swap="outerHTML"
            aria-label="{{ _('Connect session') }}">
        {{ _("Connect") }}
    </button>
    {% elif state == 'connecting' %}
    <button class="btn btn-sm btn-secondary session-connect-btn" disabled
            aria-label="{{ _('Connecting...') }}">
        <span class="btn-text">{{ _("Connecting...") }}</span>
        <span class="spinner"></span>
    </button>
    {% elif state == 'error' %}
    {# Error state that can be retried #}
    <button class="btn btn-sm btn-danger session-connect-btn"
            hx-post="/api/sessions/{{ session_id }}/connect"
            hx-target="#session-connection-{{ session_id }}"
            hx-swap="outerHTML"
            aria-label="{{ _('Retry connection') }}"
            title="{{ error or _('Connection error') }}">
        {{ _("Retry") }}
    </button>
    {% elif state == 'banned' %}
    {# Banned - cannot retry #}
    <button class="btn btn-sm btn-danger session-connect-btn" disabled
            aria-label="{{ _('Account banned') }}"
            title="{{ error or _('This account has been banned by Telegram') }}">
        <span class="btn-text">{{ _("Banned") }}</span>
    </button>
    {% elif state == 'needs_config' %}
    <button class="btn btn-sm btn-secondary session-connect-btn" disabled
            aria-label="{{ _('Not configured') }}"
            title="{{ _('Configure session first') }}">
        <span class="btn-text">{{ _("Connect") }}</span>
    </button>
    {% else %}
    {# Unknown state - show disabled connect #}
    <button class="btn btn-sm btn-secondary session-connect-btn" disabled
            aria-label="{{ _('Unknown state') }}">
        <span class="btn-text">{{ _("Connect") }}</span>
    </button>
    {% endif %}
</div>
