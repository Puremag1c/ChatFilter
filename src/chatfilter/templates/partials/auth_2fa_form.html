{# Auth Flow - 2FA Password Form #}
<div class="auth-step">
    <div class="alert alert-warning">
        <strong>{{ _("Two-Factor Authentication Required") }}</strong>
        {{ _("Your account has 2FA enabled. Please enter your password to continue.") }}
    </div>

    <p class="auth-info">
        {{ _("Session:") }} <strong>{{ session_name }}</strong>
    </p>

    {% if error %}
    <div class="alert alert-error">{{ error }}</div>
    {% endif %}

    <form id="auth-2fa-form"
          hx-post="/api/sessions/auth/2fa"
          hx-target="#auth-flow-result"
          hx-swap="innerHTML"
          hx-indicator="#auth-2fa-spinner">

        <input type="hidden" name="auth_id" value="{{ auth_id }}">

        <div class="form-group">
            <label for="auth-password"
                   data-tooltip="{{ _('Enter your Telegram 2FA password') }}"
                   data-tooltip-position="right">{{ _("2FA Password") }}</label>
            <input type="password"
                   id="auth-password"
                   name="password"
                   required
                   placeholder="{{ _('Your 2FA password') }}"
                   autocomplete="current-password"
                   autofocus
                   aria-describedby="auth-password-hint"
                   aria-required="true">
            <small id="auth-password-hint" class="form-hint">{{ _("Enter the password you set in Telegram Settings > Privacy and Security > Two-Step Verification") }}</small>
        </div>

        <div class="form-actions">
            <button type="submit" class="btn btn-primary">
                <span class="btn-text">{{ _("Complete Authentication") }}</span>
                <span id="auth-2fa-spinner" class="htmx-indicator spinner"></span>
            </button>
        </div>
    </form>

    <p class="auth-note" style="margin-top: 1rem; font-size: 0.875rem; color: var(--text-secondary);">
        {{ _("Note: Your password is sent securely and is never stored.") }}
    </p>
</div>
